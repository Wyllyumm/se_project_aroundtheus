!function(){"use strict";var e=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._settings=e,this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent=null,t.classList.remove(this._errorClass)}_hasInvalidInput(e){return!e.every((e=>e.validity.valid))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}toggleButtonState(){this._hasInvalidInput(this._inputEls)?this._disableButton():this._enableButton()}_setEventListeners(){this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}resetValidation(){this._inputEls.forEach((e=>{this._hideInputError(e)})),this.toggleButtonState()}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}};const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};var s=class{constructor(e,t,s,r,i){this._name=e.name,this._link=e.link,this.id=e._id,this.isLiked=e.isLiked,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteCard=r,this._handleLikeCard=i}getId(){return this.id}setIsLiked(e){this.isLiked=e,this.handleLikeButton()}handleLikeButton(){this.isLiked?this._likeButton.classList.add("cards__like-button_active"):this._likeButton.classList.remove("cards__like-button_active")}handleDeleteButton(){this._deleteButton.closest(".card").remove()}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeCard(this)})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteCard(this)})),this._cardImage.addEventListener("click",(()=>this._handleImageClick({link:this._link,name:this._name})))}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getView(){return this._element=this._getTemplate(),this._element.querySelector(".cards__title").textContent=this._name,this._likeButton=this._element.querySelector(".cards__like-button"),this._deleteButton=this._element.querySelector(".cards__delete-button"),this._cardImage=this._element.querySelector(".cards__image"),this._cardImage.setAttribute("src",this._link),this._cardImage.setAttribute("alt",this._name),this.handleLikeButton(),this._setEventListeners(),this._element}};class r{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class i{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}_escToCloseListener=e=>{"Escape"!==e.key&&"Esc"!==e.key||(e.preventDefault(),this.close())};open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._escToCloseListener)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._escToCloseListener)}setEventListeners(){this._popupCloseButton=this._popupElement.querySelector(".modal__close"),this._popupCloseButton.addEventListener("click",(()=>this.close())),this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal_opened")&&this.close()}))}}class n extends i{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputList=[...this._popupForm.querySelectorAll(".modal__input")],this._submitButton=this._popupForm.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this.setLoading(!0),this._handleFormSubmit(this._getInputValues()),this._popupForm.reset(),this.close()}))}}const o=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}getProfileInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}patchProfileInfo(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}patchProfileAvatar(e){let{avatar:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).catch((e=>{console.error(e)}))}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}postCards(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}dislikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"967eb4d1-2e88-4a75-bdf4-9be2dee67768","Content-Type":"application/json"}});o.getProfileInfo().then((e=>{let{name:t,about:s,avatar:r}=e;C.setUserInfo({name:t,about:s}),C.setAvatar({avatar:r})})),o.getInitialCards().then((e=>{new r({items:e,renderer:k},".cards__list").renderItems()}));const a=document.querySelector(".profile__image-edit-icon"),l=document.querySelector("#profile-edit-button"),c=document.querySelector("#profile-edit-modal"),d=document.querySelector("#card-add-modal"),u=document.querySelector("#avatar-modal"),h=document.querySelector("#card-add-button"),_=document.querySelector("#profile-title-input"),m=document.querySelector("#profile-description-input"),p=u.querySelector("#avatar-edit-form"),v=c.querySelector("#profile-edit-form"),E=d.querySelector("#add-card-form"),b=new class extends i{constructor(e){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._deleteConfirm=this._popupElement.querySelector("#confirm-delete-button")}setSubmit(e){this._handleDeleteConfirm=e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleDeleteConfirm(),this.close()}))}}("#delete-modal");function f(e){b.open(),b.setSubmit((()=>{o.deleteCard(e.getId()).then((()=>e.handleDeleteButton()))}))}function S(e){e.isLiked?o.dislikeCard(e.getId()).then((()=>{e.setIsLiked(!1)})):o.likeCard(e.getId()).then((()=>{e.setIsLiked(!0)}))}b.setEventListeners();const L=new r({items:[],renderer:k},".cards__list");function k(e){const t=function(e){return new s(e,"#card-template",y,f,S).getView()}(e);L.addItem(t)}const C=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:r}=e;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(s),this._avatarElement=document.querySelector(r)}getUserInfo(){return{name:this._nameElement.textContent,about:this._jobElement.textContent}}setUserInfo(e){let{name:t,about:s}=e;this._nameElement.textContent=t,this._jobElement.textContent=s}setAvatar(e){let{avatar:t}=e;this._avatarElement.src=t}}({nameSelector:".profile__title",jobSelector:".profile__description",avatarSelector:".profile__image"}),g=new class extends i{constructor(e){super({popupSelector:e}),this._previewImage=this._popupElement.querySelector("#preview-image"),this._previewCaption=this._popupElement.querySelector("#preview-image-caption")}open(e){this._previewImage.src=e.link,this._previewImage.alt=e.name,this._previewCaption.textContent=e.name,super.open()}}("#image-modal");function y(e){g.open(e)}g.setEventListeners();const I=new n("#card-add-modal",(function(e){o.postCards(e).then((()=>{k({name:e.name,link:e.link})})).finally((()=>{I.setLoading(!1)}))}));I.setEventListeners();const B=new n("#profile-edit-modal",(function(e){return o.patchProfileInfo(e).then((()=>{C.setUserInfo({name:e.name,about:e.about})})).finally((()=>{B.setLoading(!1)}))}));B.setEventListeners();const q=new n("#avatar-modal",(function(e){return o.patchProfileAvatar(e).then((()=>{C.setAvatar({avatar:e.avatar})}))}));q.setEventListeners(),l.addEventListener("click",(()=>{const{name:e,about:t}=C.getUserInfo();_.value=e,m.value=t,B.open(),w.resetValidation()})),h.addEventListener("click",(()=>{I.open(),j.toggleButtonState()})),a.addEventListener("click",(()=>{q.open(),$.toggleButtonState()}));const w=new e(t,v),j=new e(t,E),$=new e(t,p);w.enableValidation(),j.enableValidation(),$.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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MUJnSCxFQUF3QnJELE1BQVErQixFQUNoQ2tELEVBQWdCakcsT0FDaEJtRyxFQUFrQnhKLGlCQUFpQixJQUdyQ3dILEVBQWlCMUgsaUJBQWlCLFNBQVMsS0FDekNzSixFQUFhL0YsT0FDYm9HLEVBQWlCOUosbUJBQW1CLElBR3RDd0gsRUFBZ0JySCxpQkFBaUIsU0FBUyxLQUN4Q3lKLEVBQVlsRyxPQUNacUcsRUFBb0IvSixtQkFBbUIsSUFHekMsTUFBTTZKLEVBQW9CLElBQUlHLEVBQWN0TSxFQUFVdUssR0FDaEQ2QixFQUFtQixJQUFJRSxFQUFjdE0sRUFBVXdLLEdBQy9DNkIsRUFBc0IsSUFBSUMsRUFBY3RNLEVBQVVzSyxHQUN4RDZCLEVBQWtCdkosbUJBQ2xCd0osRUFBaUJ4SixtQkFDakJ5SixFQUFvQnpKLGtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBDb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWwpIHtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsO1xuICAgIHRoaXMuX3NldHRpbmdzID0gc2V0dGluZ3M7XG4gICAgdGhpcy5faW5wdXRFbHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBudWxsO1xuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkge1xuICAgIHJldHVybiAhaW5wdXRMaXN0LmV2ZXJ5KChpbnB1dEVsKSA9PiBpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCkge1xuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xuICAgIH1cbiAgfVxuXG4gIF9kaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgX2VuYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgfVxuXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRFbHMpKSB7XG4gICAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZSkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCk7XG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xuICAgIH0pO1xuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xuIiwiLypleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXG4gIH0sXG5cbiAge1xuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXG4gIH0sXG5cbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXG4gIH0sXG5cbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuXG4gIHtcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxuICB9LFxuXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXG4gIH0sXG5dOyAqL1xuXG5leHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxufTtcblxuLyogRWxlbWVudHMgXG5jb25zdCBpbWFnZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlLWVkaXQtaWNvblwiKTtcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xuY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIpO1xuY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLWFkZC1tb2RhbFwiKTtcbmNvbnN0IHByb2ZpbGVJbWFnZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItbW9kYWxcIik7XG5jb25zdCBhZGROZXdDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLWFkZC1idXR0b25cIik7XG5jb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXG4pO1xuY29uc3QgcHJvZmlsZUltYWdlRm9ybSA9IHByb2ZpbGVJbWFnZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLWVkaXQtZm9ybVwiKTtcbmNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtZm9ybVwiKTtcbmNvbnN0IGFkZENhcmRGb3JtID0gYWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtZm9ybVwiKTsgKi9cbiIsImNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICBkYXRhLFxuICAgIGNhcmRTZWxlY3RvcixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNhcmQsXG4gICAgaGFuZGxlTGlrZUNhcmRcbiAgKSB7XG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuaWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLmlzTGlrZWQgPSBkYXRhLmlzTGlrZWQ7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQgPSBoYW5kbGVEZWxldGVDYXJkO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VDYXJkID0gaGFuZGxlTGlrZUNhcmQ7XG4gIH1cbiAgZ2V0SWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuaWQ7XG4gIH1cblxuICBzZXRJc0xpa2VkKGlzTGlrZWQpIHtcbiAgICB0aGlzLmlzTGlrZWQgPSBpc0xpa2VkO1xuICAgIHRoaXMuaGFuZGxlTGlrZUJ1dHRvbigpO1xuICB9XG5cbiAgaGFuZGxlTGlrZUJ1dHRvbigpIHtcbiAgICBpZiAoXG4gICAgICB0aGlzLmlzTGlrZWRcbiAgICAgICAgPyB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkc19fbGlrZS1idXR0b25fYWN0aXZlXCIpXG4gICAgICAgIDogdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZHNfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKVxuICAgICk7XG4gIH1cbiAgaGFuZGxlRGVsZXRlQnV0dG9uKCkge1xuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5jbG9zZXN0KFwiLmNhcmRcIikucmVtb3ZlKCk7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlTGlrZUNhcmQodGhpcyk7XG4gICAgfSk7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKHRoaXMpO1xuICAgIH0pO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soeyBsaW5rOiB0aGlzLl9saW5rLCBuYW1lOiB0aGlzLl9uYW1lIH0pXG4gICAgKTtcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICByZXR1cm4gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgfVxuICBnZXRWaWV3KCkge1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fdGl0bGVcIikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpa2UtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fZGVsZXRlLWJ1dHRvblwiKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgdGhpcy5fbGluayk7XG4gICAgdGhpcy5fY2FyZEltYWdlLnNldEF0dHJpYnV0ZShcImFsdFwiLCB0aGlzLl9uYW1lKTtcbiAgICB0aGlzLmhhbmRsZUxpa2VCdXR0b24oKTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IENhcmQ7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICByZW5kZXJJdGVtcygpIHtcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG59XG5cbi8qZnVuY3Rpb24gY3JlYXRlQ2FyZChkYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gbmV3IENhcmQoZGF0YSwgXCIjY2FyZC10ZW1wbGF0ZVwiLCBoYW5kbGVJbWFnZUNsaWNrKTtcbiAgcmV0dXJuIGNhcmRFbGVtZW50LmdldFZpZXcoKTtcbn1cblxuZnVuY3Rpb24gcmVuZGVyQ2FyZChkYXRhLCB3cmFwcGVyKSB7XG4gIGNvbnN0IGNhcmQgPSBjcmVhdGVDYXJkKGRhdGEpO1xuICB0aGlzLl9jb250YWluZXIucHJlcGVuZChjYXJkKTtcbn0gKi9cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICB9XG5cbiAgX2VzY1RvQ2xvc2VMaXN0ZW5lciA9IChlKSA9PiB7XG4gICAgaWYgKGUua2V5ID09PSBcIkVzY2FwZVwiIHx8IGUua2V5ID09PSBcIkVzY1wiKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9O1xuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5fZXNjVG9DbG9zZUxpc3RlbmVyKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2VzY1RvQ2xvc2VMaXN0ZW5lcik7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cENsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xuICAgIHRoaXMuX3BvcHVwQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuY2xvc2UoKSk7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IFsuLi50aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIildO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XG4gIH1cblxuICBzZXRMb2FkaW5nKGlzTG9hZGluZywgc2F2aW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBzYXZpbmdUZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b25UZXh0O1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuc2V0TG9hZGluZyh0cnVlKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IHsgc2V0dGluZ3MgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5pbXBvcnQgUG9wdXBDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBDb25maXJtYXRpb24uanNcIjtcblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiOTY3ZWI0ZDEtMmU4OC00YTc1LWJkZjQtOWJlMmRlZTY3NzY4XCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuYXBpLmdldFByb2ZpbGVJbmZvKCkudGhlbigoeyBuYW1lLCBhYm91dCwgYXZhdGFyIH0pID0+IHtcbiAgdXNlckluZm8uc2V0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KTtcbiAgdXNlckluZm8uc2V0QXZhdGFyKHsgYXZhdGFyIH0pO1xufSk7XG5cbmFwaS5nZXRJbml0aWFsQ2FyZHMoKS50aGVuKChjYXJkRGF0YSkgPT4ge1xuICBjb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oeyBpdGVtczogY2FyZERhdGEsIHJlbmRlcmVyIH0sIFwiLmNhcmRzX19saXN0XCIpO1xuICBzZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG59KTtcblxuLyogRWxlbWVudHMgKi9cbmNvbnN0IGltYWdlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2UtZWRpdC1pY29uXCIpO1xuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XG5jb25zdCBwcm9maWxlRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWxcIik7XG5jb25zdCBhZGRDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtYWRkLW1vZGFsXCIpO1xuY29uc3QgcHJvZmlsZUltYWdlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1tb2RhbFwiKTtcbmNvbnN0IGFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtYWRkLWJ1dHRvblwiKTtcbmNvbnN0IHByb2ZpbGVUaXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXRpdGxlLWlucHV0XCIpO1xuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcbik7XG5jb25zdCBwcm9maWxlSW1hZ2VGb3JtID0gcHJvZmlsZUltYWdlTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItZWRpdC1mb3JtXCIpO1xuY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1mb3JtXCIpO1xuY29uc3QgYWRkQ2FyZEZvcm0gPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1mb3JtXCIpO1xuXG5jb25zdCBkZWxldGVDb25maXJtUG9wdXAgPSBuZXcgUG9wdXBDb25maXJtYXRpb24oXCIjZGVsZXRlLW1vZGFsXCIpO1xuZGVsZXRlQ29uZmlybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4vKiBGdW5jdGlvbnMgKi9cblxuZnVuY3Rpb24gY3JlYXRlQ2FyZChkYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gbmV3IENhcmQoXG4gICAgZGF0YSxcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBoYW5kbGVEZWxldGVDYXJkLFxuICAgIGhhbmRsZUxpa2VDYXJkXG4gICk7XG4gIHJldHVybiBjYXJkRWxlbWVudC5nZXRWaWV3KCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmQoZGF0YSkge1xuICBkZWxldGVDb25maXJtUG9wdXAub3BlbigpO1xuICBkZWxldGVDb25maXJtUG9wdXAuc2V0U3VibWl0KCgpID0+IHtcbiAgICBhcGkuZGVsZXRlQ2FyZChkYXRhLmdldElkKCkpLnRoZW4oKCkgPT4gZGF0YS5oYW5kbGVEZWxldGVCdXR0b24oKSk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVMaWtlQ2FyZChkYXRhKSB7XG4gIGlmICghZGF0YS5pc0xpa2VkKSB7XG4gICAgYXBpLmxpa2VDYXJkKGRhdGEuZ2V0SWQoKSkudGhlbigoKSA9PiB7XG4gICAgICBkYXRhLnNldElzTGlrZWQodHJ1ZSk7XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgYXBpLmRpc2xpa2VDYXJkKGRhdGEuZ2V0SWQoKSkudGhlbigoKSA9PiB7XG4gICAgICBkYXRhLnNldElzTGlrZWQoZmFsc2UpO1xuICAgIH0pO1xuICB9XG59XG5cbmNvbnN0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAge1xuICAgIGl0ZW1zOiBbXSxcbiAgICByZW5kZXJlcixcbiAgfSxcbiAgXCIuY2FyZHNfX2xpc3RcIlxuKTtcblxuZnVuY3Rpb24gcmVuZGVyZXIoZGF0YSkge1xuICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChkYXRhKTtcbiAgc2VjdGlvbi5hZGRJdGVtKGNhcmQpO1xufVxuXG4vKiBIYW5kbGVycyAqL1xuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICBuYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXG4gIGpvYlNlbGVjdG9yOiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxuICBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9faW1hZ2VcIixcbn0pO1xuXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI2ltYWdlLW1vZGFsXCIpO1xuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKGRhdGEpIHtcbiAgaW1hZ2VQb3B1cC5vcGVuKGRhdGEpO1xufVxuXG5jb25zdCBuZXdDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNjYXJkLWFkZC1tb2RhbFwiLCBoYW5kbGVDYXJkRm9ybVN1Ym1pdCk7XG5uZXdDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgbmV3UHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxuICBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdFxuKTtcbm5ld1Byb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBhdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI2F2YXRhci1tb2RhbFwiLCBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KTtcbmF2YXRhclBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmZ1bmN0aW9uIGhhbmRsZUNhcmRGb3JtU3VibWl0KGlucHV0VmFsdWVzKSB7XG4gIC8qbmV3Q2FyZFBvcHVwLnNldExvYWRpbmcodHJ1ZSk7Ki9cbiAgYXBpXG4gICAgLnBvc3RDYXJkcyhpbnB1dFZhbHVlcylcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICByZW5kZXJlcih7IG5hbWU6IGlucHV0VmFsdWVzLm5hbWUsIGxpbms6IGlucHV0VmFsdWVzLmxpbmsgfSk7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBuZXdDYXJkUG9wdXAuc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KGlucHV0VmFsdWVzKSB7XG4gIHJldHVybiBhcGlcbiAgICAucGF0Y2hQcm9maWxlSW5mbyhpbnB1dFZhbHVlcylcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XG4gICAgICAgIG5hbWU6IGlucHV0VmFsdWVzLm5hbWUsXG4gICAgICAgIGFib3V0OiBpbnB1dFZhbHVlcy5hYm91dCxcbiAgICAgIH0pO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgbmV3UHJvZmlsZVBvcHVwLnNldExvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KGlucHV0VmFsdWVzKSB7XG4gIHJldHVybiBhcGkucGF0Y2hQcm9maWxlQXZhdGFyKGlucHV0VmFsdWVzKS50aGVuKCgpID0+IHtcbiAgICB1c2VySW5mby5zZXRBdmF0YXIoeyBhdmF0YXI6IGlucHV0VmFsdWVzLmF2YXRhciB9KTtcbiAgfSk7XG59XG5cbi8qZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpIHtcbiAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgIG5hbWU6IGlucHV0VmFsdWVzLm5hbWUsXG4gICAgYWJvdXQ6IGlucHV0VmFsdWVzLmFib3V0LFxuICB9KTtcbn1vbGQgY29kZSovXG5cbi8qIEV2ZW50IExpc3RlbmVycyAqL1xuXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjb25zdCB7IG5hbWUsIGFib3V0IH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICBwcm9maWxlVGl0bGVJbnB1dC52YWx1ZSA9IG5hbWU7XG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gYWJvdXQ7XG4gIG5ld1Byb2ZpbGVQb3B1cC5vcGVuKCk7XG4gIGVkaXRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xufSk7XG5cbmFkZE5ld0NhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgbmV3Q2FyZFBvcHVwLm9wZW4oKTtcbiAgYWRkRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xufSk7XG5cbmltYWdlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBhdmF0YXJQb3B1cC5vcGVuKCk7XG4gIGF2YXRhckZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbn0pO1xuXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBwcm9maWxlRWRpdEZvcm0pO1xuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBhZGRDYXJkRm9ybSk7XG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIHByb2ZpbGVJbWFnZUZvcm0pO1xuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5hdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuICBnZXRQcm9maWxlSW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSk7XG4gIH1cblxuICBwYXRjaFByb2ZpbGVJbmZvKGlucHV0VmFsdWVzKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBpbnB1dFZhbHVlcy5uYW1lLFxuICAgICAgICBhYm91dDogaW5wdXRWYWx1ZXMuYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgcGF0Y2hQcm9maWxlQXZhdGFyKHsgYXZhdGFyIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXI6IGF2YXRhcixcbiAgICAgIH0pLFxuICAgIH0pLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSk7XG4gIH1cblxuICAvKnBvc3RDYXJkcyhuYW1lLCBsaW5rKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWUsIGxpbmsgfSksXG4gICAgfSk7XG4gIH0gKi9cblxuICBwb3N0Q2FyZHMoaW5wdXRWYWx1ZXMpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZTogaW5wdXRWYWx1ZXMubmFtZSwgbGluazogaW5wdXRWYWx1ZXMubGluayB9KSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgbGlrZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgfVxuXG4gIGRpc2xpa2VDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9kZWxldGVDb25maXJtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIiNjb25maXJtLWRlbGV0ZS1idXR0b25cIlxuICAgICk7XG4gICAgLyp0aGlzLl9oYW5kbGVEZWxldGVDb25maXJtID0gbnVsbDsgKi9cbiAgfVxuXG4gIHNldFN1Ym1pdChjb25maXJtQWN0aW9uKSB7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ29uZmlybSA9IGNvbmZpcm1BY3Rpb247XG4gIH1cblxuICAvKnNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGlmICh0aGlzLl9oYW5kbGVEZWxldGVDb25maXJtKSB7XG4gICAgICAgIHRoaXMuc2V0U3VibWl0KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmVycm9yKCk7XG4gICAgICB9XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gIH0qL1xuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNvbmZpcm0oKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xuICB9XG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIGFib3V0OiB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50LFxuICAgIH07XG4gIH1cblxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCA9IGFib3V0O1xuICB9XG5cbiAgc2V0QXZhdGFyKHsgYXZhdGFyIH0pIHtcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50LnNyYyA9IGF2YXRhcjtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX3ByZXZpZXdJbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctaW1hZ2VcIik7XG4gICAgdGhpcy5fcHJldmlld0NhcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiI3ByZXZpZXctaW1hZ2UtY2FwdGlvblwiXG4gICAgKTtcbiAgfVxuICBvcGVuKGRhdGEpIHtcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX3ByZXZpZXdJbWFnZS5hbHQgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fcHJldmlld0NhcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iXSwibmFtZXMiOlsiY29uc3RydWN0b3IiLCJzZXR0aW5ncyIsImZvcm1FbCIsInRoaXMiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybSIsIl9zZXR0aW5ncyIsIl9pbnB1dEVscyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc3VibWl0QnV0dG9uIiwicXVlcnlTZWxlY3RvciIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWwiLCJlcnJvck1lc3NhZ2VFbCIsImlkIiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsInJlbW92ZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJpbnB1dExpc3QiLCJldmVyeSIsInZhbGlkaXR5IiwidmFsaWQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX2Rpc2FibGVCdXR0b24iLCJkaXNhYmxlZCIsIl9lbmFibGVCdXR0b24iLCJ0b2dnbGVCdXR0b25TdGF0ZSIsIl9zZXRFdmVudExpc3RlbmVycyIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInJlc2V0VmFsaWRhdGlvbiIsImVuYWJsZVZhbGlkYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsImZvcm1TZWxlY3RvciIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImhhbmRsZUxpa2VDYXJkIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2lkIiwiaXNMaWtlZCIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVDYXJkIiwiX2hhbmRsZUxpa2VDYXJkIiwiZ2V0SWQiLCJzZXRJc0xpa2VkIiwiaGFuZGxlTGlrZUJ1dHRvbiIsIl9saWtlQnV0dG9uIiwiaGFuZGxlRGVsZXRlQnV0dG9uIiwiX2RlbGV0ZUJ1dHRvbiIsImNsb3Nlc3QiLCJfY2FyZEltYWdlIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZ2V0VmlldyIsIl9lbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiU2VjdGlvbiIsIl9yZWYiLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9lc2NUb0Nsb3NlTGlzdGVuZXIiLCJrZXkiLCJjbG9zZSIsIm9wZW4iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJfcG9wdXBDbG9zZUJ1dHRvbiIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9pbnB1dExpc3QiLCJfc3VibWl0QnV0dG9uVGV4dCIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInNldExvYWRpbmciLCJpc0xvYWRpbmciLCJzYXZpbmdUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwicmVzZXQiLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJnZXRQcm9maWxlSW5mbyIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsInBhdGNoUHJvZmlsZUluZm8iLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0IiwicGF0Y2hQcm9maWxlQXZhdGFyIiwiX3JlZjIiLCJhdmF0YXIiLCJnZXRJbml0aWFsQ2FyZHMiLCJwb3N0Q2FyZHMiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwibGlrZUNhcmQiLCJkaXNsaWtlQ2FyZCIsImF1dGhvcml6YXRpb24iLCJ1c2VySW5mbyIsInNldFVzZXJJbmZvIiwic2V0QXZhdGFyIiwiY2FyZERhdGEiLCJpbWFnZUVkaXRCdXR0b24iLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVFZGl0TW9kYWwiLCJhZGRDYXJkTW9kYWwiLCJwcm9maWxlSW1hZ2VNb2RhbCIsImFkZE5ld0NhcmRCdXR0b24iLCJwcm9maWxlVGl0bGVJbnB1dCIsInByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwicHJvZmlsZUltYWdlRm9ybSIsInByb2ZpbGVFZGl0Rm9ybSIsImFkZENhcmRGb3JtIiwiZGVsZXRlQ29uZmlybVBvcHVwIiwiX2RlbGV0ZUNvbmZpcm0iLCJzZXRTdWJtaXQiLCJjb25maXJtQWN0aW9uIiwiX2hhbmRsZURlbGV0ZUNvbmZpcm0iLCJzZWN0aW9uIiwiY2FyZCIsIkNhcmQiLCJjcmVhdGVDYXJkIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9qb2JFbGVtZW50IiwiX2F2YXRhckVsZW1lbnQiLCJnZXRVc2VySW5mbyIsIl9yZWYzIiwic3JjIiwiaW1hZ2VQb3B1cCIsIl9wcmV2aWV3SW1hZ2UiLCJfcHJldmlld0NhcHRpb24iLCJhbHQiLCJuZXdDYXJkUG9wdXAiLCJmaW5hbGx5IiwibmV3UHJvZmlsZVBvcHVwIiwiYXZhdGFyUG9wdXAiLCJlZGl0Rm9ybVZhbGlkYXRvciIsImFkZEZvcm1WYWxpZGF0b3IiLCJhdmF0YXJGb3JtVmFsaWRhdG9yIiwiRm9ybVZhbGlkYXRvciJdLCJzb3VyY2VSb290IjoiIn0=